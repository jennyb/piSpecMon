<div *ngIf="stateService.ready" class="container-fluid">
  <div class="row">
    <div class="col-lg-12">
      <h1 class="header"><img src="ofcom.gif" alt="Ofcom"> <span class="name">{{stateService.values.ident.name}}</span> ({{stateService.values.ident.description}})</h1>
      <psm-login [user]="user"></psm-login>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-9">
      <psm-table #table [modes]="modes" [user]="user" [status]="status"></psm-table>
      <!--div class="error" *ngFor="let error of errors">{{error[0] | date}} {{error[1]}}</div FIXME -->
      <div>
        <h2>Processes</h2>
        <div *ngIf="monkey && (monkey.timestamp || monkey.error)" [ngClass]="{ status: true, error: monkey.error != undefined }">
          <h2 *ngIf="monkey.timestamp">RDS status at {{monkey.timestamp | date}}</h2>
          <span *ngIf="monkey.started">Scan started {{monkey.started | date}}</span>
          <span *ngIf="monkey.sweep">Sweep {{monkey.sweep.sweep_n + 1}} started at {{monkey.sweep.timestamp | date}}</span>
          <span *ngIf="monkey.freq_n != undefined">Receiving on {{monkey.freq_n | freq:values}}</span>
          <span *ngIf="monkey.strength != undefined">Strength: {{monkey.strength}}</span>
          <span *ngIf="monkey.name">Station name: {{monkey.name}}</span>
          <span *ngIf="monkey.text"><i>{{monkey.text}}</i></span>
          <span *ngIf="monkey.error">{{monkey.error}}</span>
        </div>
        <div *ngIf="! running" class="message">
          Not running
        </div>
        <button (click)="onStart()" class="btn btn-default" [disabled]="! showStart">Start</button>
        <button (click)="onStop()" class="btn btn-default" [disabled]="! showStop">Stop</button>
      </div>
      <psm-charts [hidden]="config == undefined"></psm-charts>
    </div>
    <div class="col-lg-3">
      <psm-error></psm-error>
      <psm-ident></psm-ident>
      <!--psm-details [user]="user"></psm-details FIXME -->
      <psm-logs *ngIf="user.roleIn(['admin'])"></psm-logs>
      <psm-pi *ngIf="user.roleIn(['admin'])"></psm-pi>
      <psm-pico *ngIf="user.roleIn(['admin'])"></psm-pico>
      <psm-stats *ngIf="user.roleIn(['admin'])"></psm-stats>
      <!--psm-rig *ngIf="user.roleIn(['admin'])" [models]="models" [rates]="rates" [parities]="parities"></psm-rig-->
      <psm-audio *ngIf="user.roleIn(['admin', 'freq'])"></psm-audio>
      <psm-rds [status]="status"></psm-rds>
      <!--psm-scan [modes]="modes" [status]="status"></psm-scan-->
    </div>
  </div>
</div>
<div id="messageModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title"></h4>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Dismiss</button>
      </div>
    </div>
  </div>
</div>
