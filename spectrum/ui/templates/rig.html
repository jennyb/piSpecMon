<psm-widget title="Configuration">
  <form role="form" #rigForm="ngForm">
    <div class="form-group">
      <label for="model">Model</label>
      <select class="form-control" [disabled]="loading" [(ngModel)]="rig.model" name="model">
        <option *ngFor="let model of caps.models" value="{{model.model}}">{{model.manufacturer}} {{model.name}} v{{model.version}} ({{model.status}})</option>
      </select>
    </div>
    <div class="form-group">
      <label for="rig_device">Rig serial port device</label>
      <input [disabled]="loading" type="text" required class="form-control" required [(ngModel)]="rig.rig_device" name="rig_device" #rig_device="ngModel">
    </div>
    <div [hidden]="rig_device.valid || rig_device.pristine" class="alert alert-danger">
      Serial port device is a required parameter
    </div>
    <div class="form-group">
      <div class="psm-input-group col-lg-6">
        <label for="data">Data bits</label>
        <input [disabled]="loading" type="number" pattern="[0-9]+" min="1" max="8" step="1" class="form-control" required [(ngModel)]="rig.data_bits" name="data" #data="ngModel">
      </div>
      <div class="psm-input-group col-lg-6">
        <label for="rate">Rate</label>
        <select class="form-control" [disabled]="loading" [(ngModel)]="rig.rate" name="rate">
          <option *ngFor="let rate of caps.rates" value="{{rate.rate}}">{{rate.label}}</option>
        </select>
      </div>
    </div>
    <div [hidden]="data.valid || data.pristine" class="alert alert-danger">
      Data bits is a required parameter, and must be an integer
    </div>
    <div class="form-group">
      <div class="psm-input-group col-lg-6">
        <label for="stop">Stop bits</label>
        <input [disabled]="loading" type="number" min="1" max="2" step="0.5" class="form-control" required [(ngModel)]="rig.stop_bits" name="stop" #stop="ngModel">
      </div>
      <div class="psm-input-group col-lg-6">
        <label for="parity">Parity</label>
        <select class="form-control" [disabled]="loading" [(ngModel)]="rig.parity" name="parity">
          <option *ngFor="let parity of caps.parities" value="{{parity.value}}">{{parity.label}}</option>
        </select>
      </div>
    </div>
    <div [hidden]="stop.valid || stop.pristine" class="alert alert-danger">
      Stop bits is a required parameter
    </div>
    <div class="form-group">
      <div class="psm-input-group col-lg-6">
        <label for="delay">Write delay (ms)</label>
        <input [disabled]="loading" type="number" min="0" pattern="[0-9]+" required class="form-control" [(ngModel)]="rig.write_delay" name="delay" #delay="ngModel">
      </div>
      <div class="psm-input-group col-lg-6">
        <label for="interval">Retry interval (ms)</label>
        <input [disabled]="loading" type="number" min="0" pattern="[0-9]+" required class="form-control" [(ngModel)]="rig.interval" name="interval" #interval="ngModel">
      </div>
    </div>
    <div [hidden]="delay.valid || delay.pristine" class="alert alert-danger">
      Write delay is a required parameter, and must be an integer
    </div>
    <div [hidden]="interval.valid || interval.pristine" class="alert alert-danger">
      Retry interval is a required parameter, and must be an integer
    </div>
    <div class="form-group">
      <label for="attempts">Set frequency attempts</label>
      <select [disabled]="loading" class="form-control" [(ngModel)]="rig.set_check" name="attempts">
        <option value="0">Set once only</option>
        <option value="1">Set once and check</option>
        <option value="2">Set and check up to twice</option>
        <option value="3">Set and check up to three times</option>
      </select>
    </div>
    <div class="form-group">
      <label for="retries">Error handling</label>
      <select [disabled]="loading" class="form-control" [(ngModel)]="rig.retries" name="retries">
        <option value="0">Fail on error</option>
        <option value="1">Wait and retry once</option>
        <option value="2">Wait and retry twice</option>
        <option value="3">Wait and retry three times</option>
      </select>
    </div>
    <div class="form-group">
      <div class="psm-input-group col-lg-6">
        <label for="radio_on">Radio on attempts</label>
        <select [disabled]="loading" class="form-control" [(ngModel)]="rig.radio_on" name="radio_on">
          <option value="0">Never</option>
          <option value="1">Try once</option>
          <option value="2">Try twice</option>
          <option value="3">Try three times</option>
          <option value="*">Try forever</option>
        </select>
      </div>
      <div class="psm-input-group col-lg-6">
        <label for="attenuation">Attenuation</label>
        <select [disabled]="loading" class="form-control" [(ngModel)]="rig.attenuation" name="attenuation">
          <option value="true">On</option>
          <option value="false">Off</option>
        </select>
      </div>
    </div>
    <div class="form-group">
      <div class="psm-input-group col-lg-6">
        <label for="audio_device">Audio device</label>
        <input [disabled]="loading" type="text" required class="form-control" [(ngModel)]="rig.audio_device" name="audio_device" #audio_device="ngModel">
      </div>
      <div class="psm-input-group col-lg-6">
        <label for="rds_device">RDS device</label>
        <input [disabled]="loading" type="text" required class="form-control" [(ngModel)]="rig.rds_device" name="rds_device" #rds_device="ngModel">
      </div>
    </div>
    <div [hidden]="audio_device.valid || audio_device.pristine" class="alert alert-danger">
      Audio device path is a required parameter
    </div>
    <div [hidden]="rds_device.valid || rds_device.pristine" class="alert alert-danger">
      RDS device path is a required parameter
    </div>
    <button (click)="onReset()" class="btn btn-default" [disabled]="loading || rigForm.form.pristine">Reset</button>
    <button (click)="onSubmit()" class="btn btn-default" [disabled]="loading || ! rigForm.form.valid || rigForm.form.pristine">Submit</button>
  </form>
</psm-widget>
