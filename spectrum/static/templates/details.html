<psm-widget title="User Details">
  <form role="form" (ngSubmit)="onSubmit()" #form="ngForm">
    <div class="form-group">
      <label for="role">Role</label>
      <input [disabled]="loading" type="text" readonly class="form-control" [(ngModel)]="user._roleLabel" name="role">
    </div>
    <div class="form-group">
      <label for="name">User name</label>
      <input [disabled]="loading" type="text" readonly class="form-control" [(ngModel)]="user.name" name="name">
    </div>
    <div class="form-group">
      <label for="real">Real name</label>
      <input [disabled]="loading" type="text" required class="form-control" [(ngModel)]="user.real" name="real" #real="ngModel">
      <div [hidden]="real.valid || real.pristine" class="alert alert-danger">
        Real name is a required parameter
      </div>
    </div>
    <div class="form-group">
      <label for="email">Email address</label>
      <input [disabled]="loading" type="text" required class="form-control" [(ngModel)]="user.email" name="email" #email="ngModel">
      <div [hidden]="email.valid || email.pristine" class="alert alert-danger">
        Email address is a required parameter
      </div>
    </div>
    <div class="form-group">
      <label for="tel">Telephone number</label>
      <input [disabled]="loading" type="text" required class="form-control" [(ngModel)]="user.tel" name="tel" #tel="ngModel">
      <div [hidden]="tel.valid || tel.pristine" class="alert alert-danger">
        Telephone number is a required parameter
      </div>
    </div>
    <button type="button" (click)="onReset()" class="btn btn-default" [disabled]="loading || form.form.pristine">Reset</button>
    <button type="submit" class="btn btn-default" [disabled]="loading || ! form.form.valid || form.form.pristine">Submit</button>
    <button type="button" (click)="resetPasswords()" class="btn btn-link" [disabled]="loading" data-toggle="modal" data-target="#passwordModal">Change Password</button>
  </form>
  <div id="passwordModal" class="modal fade" role="dialog">
    <form role="form" #passwordForm="ngForm">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Change Password</h4>
          </div>
          <div class="modal-body">
              <div class="form-group">
                <label for="old">Old password</label>
                <input type="text" required class="form-control" [(ngModel)]="oldPassword" name="old">
              </div>
              <div class="form-group">
                <label for="new">New password</label>
                <input type="text" required class="form-control" [(ngModel)]="newPassword" name="new">
              </div>
          </div>
          <div class="modal-footer">
            <button type="submit" (click)="onPassword()" class="btn btn-default" data-dismiss="modal" [disabled]="! passwordForm.form.valid || oldPassword == newPassword">Submit</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Dismiss</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</psm-widget>
